<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Plan de classe 403</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
    }
    .container {
      display: flex;
      gap: 40px;
    }
    .cases {
      flex: 1;
    }
    .case-box {
      background-color: #87CEEB; /* bleu ciel */
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 10px;
      margin-bottom: 20px;
      transition: background-color 0.3s, color 0.3s;
      cursor: pointer;
    }
    .case-box.checked {
      background-color: #006400; /* vert foncé */
      color: #fff;
    }
    .options {
      margin-top: 10px;
      margin-left: 20px;
    }
    .result {
      flex: 1;
      padding-left: 20px;
    }
    #result-list {
      list-style: none;
      padding: 0;
    }
    #result-list li {
      margin-bottom: 5px;
    }
    .case-label {
      display: flex;
      align-items: center;
      gap: 8px;
      pointer-events: none; /* ignore label clicks, handled on box */
    }
    .case-box input {
      pointer-events: none; /* disable default checkbox clicking */
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="cases">
      <div class="case-box" id="box-1">
        <label class="case-label">
          <input type="checkbox" id="main-case-1">
          <span>case 1</span>
        </label>
        <div class="options" id="options-1" style="display: none;">
          <label><input type="checkbox" data-case="1" value="Comportement"> Comportement</label><br>
          <label><input type="checkbox" data-case="1" value="Travail non fait"> Travail non fait</label><br>
          <label><input type="checkbox" data-case="1" value="Oubli de matériel"> Oubli de matériel</label>
        </div>
      </div>

      <div class="case-box" id="box-2">
        <label class="case-label">
          <input type="checkbox" id="main-case-2">
          <span>case 2</span>
        </label>
        <div class="options" id="options-2" style="display: none;">
          <label><input type="checkbox" data-case="2" value="Comportement"> Comportement</label><br>
          <label><input type="checkbox" data-case="2" value="Travail non fait"> Travail non fait</label><br>
          <label><input type="checkbox" data-case="2" value="Oubli de matériel"> Oubli de matériel</label>
        </div>
      </div>
    </div>

    <div class="result">
      <ul id="result-list"></ul>
    </div>
  </div>

  <script>
    ['1','2'].forEach(function(n) {
      const mainCb = document.getElementById('main-case-' + n);
      const box = document.getElementById('box-' + n);
      const optDiv = document.getElementById('options-' + n);

      // Update on checkbox change
      mainCb.addEventListener('change', function() {
        const checked = this.checked;
        optDiv.style.display = checked ? 'block' : 'none';
        box.classList.toggle('checked', checked);
        if (!checked) {
          optDiv.querySelectorAll('input[type="checkbox"]').forEach(function(cb) {
            if (cb.checked) {
              cb.checked = false;
              removeResult(n, cb.value);
            }
          });
        }
      });

      // Toggle when clicking on the box (excluding options area)
      box.addEventListener('click', function(e) {
        // Ignore clicks inside the options div
        if (e.target.closest('#options-' + n)) return;
        // Toggle the main checkbox
        mainCb.checked = !mainCb.checked;
        mainCb.dispatchEvent(new Event('change'));
      });
    });

    document.querySelectorAll('.options input[type="checkbox"]').forEach(function(cb) {
      cb.addEventListener('change', function() {
        const caseNum = this.dataset.case;
        const val = this.value;
        if (this.checked) addResult(caseNum, val);
        else removeResult(caseNum, val);
      });
    });

    function addResult(caseNum, value) {
      const ul = document.getElementById('result-list');
      const li = document.createElement('li');
      li.id = `result-${caseNum}-${value}`;
      li.textContent = `case n°${caseNum} : ${value}`;
      ul.appendChild(li);
    }

    function removeResult(caseNum, value) {
      const li = document.getElementById(`result-${caseNum}-${value}`);
      if (li) li.remove();
    }
  </script>

</body>
</html>
