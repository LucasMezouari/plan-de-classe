<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Plan de classe 403</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f8f8f8;
      padding: 20px;
      text-align: center;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(3, 160px);
      gap: 20px 50px;
      justify-content: center;
    }
    .cell { position: relative; }
    .half {
      position: relative;
      width: 160px;
      height: 60px;
      background-color: #ffffff;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-shadow: 1px 1px 4px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      font-weight: bold;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.2s;
      overflow: visible;
    }
    .half.active { background-color: #c8facc; }
    .toggle-notes {
      position: absolute;
      top: 4px;
      right: 4px;
      width: 14px;
      height: 14px;
      cursor: pointer;
      display: none;
    }
    .notes-options {
      display: none;
      position: absolute;
      top: 22px;
      right: 4px;
      background: #fff;
      border: 1px solid #aaa;
      border-radius: 4px;
      box-shadow: 2px 2px 6px rgba(0,0,0,0.1);
      padding: 4px 8px;
      font-size: 12px;
      text-align: left;
      z-index: 9;
    }
    .notes-options label { display: block; margin-bottom: 2px; cursor: pointer; }
    .footer-layout {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-top: 50px;
      position: relative;
    }
    .left-button { position: absolute; left: 20px; top: 100px; text-align: left; }
    .bouton, .tableau {
      width: 200px;
      height: 40px;
      background-color: #e0e0e0;
      border: 2px solid #666;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 16px;
      box-shadow: 2px 2px 6px rgba(0,0,0,0.2);
      cursor: pointer;
      margin-top: 10px;
    }
    #presence-result {
      position: absolute;
      left: 20px;
      top: 140px;
      text-align: left;
      font-size: 14px;
      color: #222;
      width: 200px;
    }
  </style>
</head>
<body>
  <h1>Plan de classe 403</h1>
  <div class="grid">
    <!-- 15 cellules, 30 moitiés -->
    <div class="cell">
      <div class="half">
        case 1
        <input type="checkbox" class="toggle-notes">
        <div class="notes-options">
          <label><input type="checkbox" value="Comportement"> Comportement</label>
          <label><input type="checkbox" value="Travail non fait"> Travail non fait</label>
          <label><input type="checkbox" value="Oubli de matériel"> Oubli de matériel</label>
        </div>
      </div>
      <div class="half">
        case 2
        <input type="checkbox" class="toggle-notes">
        <div class="notes-options">
          <label><input type="checkbox" value="Comportement"> Comportement</label>
          <label><input type="checkbox" value="Travail non fait"> Travail non fait</label>
          <label><input type="checkbox" value="Oubli de matériel"> Oubli de matériel</label>
        </div>
      </div>
    </div>
    <!-- Répéter pour chaque paire jusqu'à case 30 -->
    <div class="cell">
      <div class="half">
        case 3
        <input type="checkbox" class="toggle-notes">
        <div class="notes-options">
          <label><input type="checkbox" value="Comportement"> Comportement</label>
          <label><input type="checkbox" value="Travail non fait"> Travail non fait</label>
          <label><input type="checkbox" value="Oubli de matériel"> Oubli de matériel</label>
        </div>
      </div>
      <div class="half">
        case 4
        <input type="checkbox" class="toggle-notes">
        <div class="notes-options">
          <label><input type="checkbox" value="Comportement"> Comportement</label>
          <label><input type="checkbox" value="Travail non fait"> Travail non fait</label>
          <label><input type="checkbox" value="Oubli de matériel"> Oubli de matériel</label>
        </div>
      </div>
    </div>
    <!-- … continue jusqu’à -->
    <div class="cell">
      <div class="half">
        case 29
        <input type="checkbox" class="toggle-notes">
        <div class="notes-options">
          <label><input type="checkbox" value="Comportement"> Comportement</label>
          <label><input type="checkbox" value="Travail non fait"> Travail non fait</label>
          <label><input type="checkbox" value="Oubli de matériel"> Oubli de matériel</label>
        </div>
      </div>
      <div class="half">
        case 30
        <input type="checkbox" class="toggle-notes">
        <div class="notes-options">
          <label><input type="checkbox" value="Comportement"> Comportement</label>
          <label><input type="checkbox" value="Travail non fait"> Travail non fait</label>
          <label><input type="checkbox" value="Oubli de matériel"> Oubli de matériel</label>
        </div>
      </div>
    </div>
  </div>

  <div class="footer-layout">
    <div class="left-button">
      <div class="bouton" onclick="afficherAppel()">Appel terminé</div>
    </div>
    <div class="tableau">Tableau</div>
  </div>

  <div id="presence-result"></div>

  <script>
    // Masquer toutes les toggles de notes
    document.querySelectorAll('.toggle-notes')
            .forEach(cb => cb.style.display = 'none');

    // Gestion de la présence et des notes
    document.querySelectorAll('.half').forEach(half => {
      const cbNotes   = half.querySelector('.toggle-notes');
      const notesOpts = half.querySelector('.notes-options');

      half.addEventListener('click', () => {
        half.classList.toggle('active');
        if (half.classList.contains('active')) {
          cbNotes.style.display = 'block';
        } else {
          cbNotes.checked = false;
          cbNotes.style.display = 'none';
          notesOpts.style.display = 'none';
          notesOpts.querySelectorAll('input[type="checkbox"]')
                   .forEach(i => i.checked = false);
        }
      });

      cbNotes.addEventListener('change', () => {
        notesOpts.style.display = cbNotes.checked ? 'block' : 'none';
      });
    });

    // Fonction Appel terminé
    function afficherAppel() {
      const halves   = Array.from(document.querySelectorAll('.half'));
      const pres     = halves.filter(h => h.classList.contains('active'));
      const abs      = halves.filter(h => !h.classList.contains('active'));
      const presNames= [...new Set(pres.map(h => h.textContent.trim()))];
      const absNames = [...new Set(abs.map(h => h.textContent.trim()))];
      document.getElementById('presence-result').innerHTML = `
        <div><strong>Présents (${presNames.length}) :</strong> ${presNames.join(', ')}</div>
        <div style="margin-top:8px;"><strong>Absents (${absNames.length}) :</strong> ${absNames.join(', ')}</div>
      `;
    }
  </script>
</body>
</html>
